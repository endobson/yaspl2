#:module (fill-stack-test)
#:import {
  (io)
  (list)
  (numbers)
  (prim)
}
(export)
(types)


(define (fill-stack-frame-a [arr : (Array Int)]) : Int
  (+ (fill-stack-frame-b arr) 0))

(define (fill-stack-frame-b [arr : (Array Int)]) : Int
  (+ (fill-stack-frame-c arr) 1))

(define (fill-stack-frame-c [arr : (Array Int)]) : Int
  (- (fill-stack arr) 1))


(define (main [args : (Array Bytes)] [stdin : InputPort] [stdout : OutputPort] [stderr : OutputPort]) : Int
  (match-define buffer (make-array 6 0))
  (match-define fill-count (fill-stack-frame-a buffer))
  (begin
    (write-all-bytes #"depth: " stdout)
    (write-line (integer->decimal-bytes fill-count) stdout)
    (for-each
      (lambda ([x : Int])
        (write-line (integer->hex-bytes x) stdout))
      (array->list buffer))
    0))
