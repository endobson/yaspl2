(module ip
  (import
    (numbers integer->decimal-bytes)
    (bytes bytes-append)
    (list list))
  (export
    ipv4-address ipv4-address-octet1 ipv4-address-octet2 ipv4-address-octet3 ipv4-address-octet4
    ipv4-address->bytes)
  (types
    (define-type Ipv4Address
      (ipv4-address [octet1 Byte] [octet2 Byte] [octet3 Byte] [octet4 Byte])))

  (define (ipv4-address->bytes [addr : Ipv4Address]) : Bytes
    (bytes-append
      (varargs list
        (integer->decimal-bytes (ipv4-address-octet1 addr))
        #"."
        (integer->decimal-bytes (ipv4-address-octet2 addr))
        #"."
        (integer->decimal-bytes (ipv4-address-octet3 addr))
        #"."
        (integer->decimal-bytes (ipv4-address-octet4 addr))))))
